<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Rooms - Luxury Hotel</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Crimson+Text:wght@400;600&display=swap" rel="stylesheet">
    <style>
        .rooms-page {
            padding: 100px 0 50px;
            min-height: 100vh;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #2a2a2a 100%);
            color: #e5e4e2;
        }

        .page-header {
            text-align: center;
            margin-bottom: 3rem;
            padding: 2rem 0;
        }

        .page-header h1 {
            font-size: 3rem;
            color: #d4af37;
            margin-bottom: 1rem;
            font-family: 'Crimson Text', serif;
        }

        .page-header p {
            font-size: 1.2rem;
            color: #b0b0b0;
            max-width: 600px;
            margin: 0 auto;
            font-family: 'Lato', sans-serif;
        }

        .rooms-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .room-card {
            background: linear-gradient(145deg, #1a1a1a, #2a2a2a);
            border-radius: 15px;
            overflow: hidden;
            border: 1px solid rgba(212,175,55,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.1);
            transition: all 0.4s ease;
            position: relative;
        }

        .room-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 15px 45px rgba(212,175,55,0.3), inset 0 1px 0 rgba(255,255,255,0.2);
            border-color: rgba(212,175,55,0.4);
        }

        .room-image {
            width: 100%;
            height: 250px;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .room-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .room-card:hover .room-overlay {
            opacity: 1;
        }

        .room-status {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
        }

        .status-available { background: #27ae60; }
        .status-occupied { background: #e74c3c; }
        .status-reserved { background: #f39c12; }

        .room-content {
            padding: 1.5rem;
        }

        .room-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 1rem;
        }

        .room-name {
            font-size: 1.5rem;
            color: #d4af37;
            margin: 0;
            font-family: 'Crimson Text', serif;
        }

        .room-price {
            font-size: 1.8rem;
            font-weight: bold;
            color: #d4af37;
        }

        .room-type {
            color: #b0b0b0;
            font-size: 1rem;
            margin-bottom: 1rem;
            font-family: 'Lato', sans-serif;
        }

        .room-description {
            color: #b0b0b0;
            margin-bottom: 1.5rem;
            line-height: 1.6;
            font-family: 'Lato', sans-serif;
        }

        .room-amenities {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .amenity-tag {
            background: linear-gradient(45deg, #d4af37, #b89529);
            color: #111;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-family: 'Lato', sans-serif;
        }

        .room-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .room-capacity {
            color: #b0b0b0;
            font-size: 0.9rem;
            font-family: 'Lato', sans-serif;
        }

        .book-btn {
            background: linear-gradient(45deg, #d4af37, #b89529);
            color: #111;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
            font-family: 'Lato', sans-serif;
        }

        .book-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 20px rgba(212,175,55,0.4);
        }

        .book-btn:disabled {
            background: #95a5a6;
            cursor: not-allowed;
        }

        .filter-section {
            background: linear-gradient(145deg, #1a1a1a, #2a2a2a);
            padding: 2rem;
            border-radius: 10px;
            border: 1px solid rgba(212,175,55,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.5);
            margin-bottom: 2rem;
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-group label {
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: #d4af37;
            font-family: 'Lato', sans-serif;
        }

        .filter-group select, .filter-group input {
            padding: 0.8rem;
            border: 2px solid rgba(212,175,55,0.3);
            background: #111;
            color: #e5e4e2;
            border-radius: 5px;
            font-size: 1rem;
            font-family: 'Lato', sans-serif;
            transition: border-color 0.3s;
        }

        .filter-group select:focus, .filter-group input:focus {
            outline: none;
            border-color: #d4af37;
        }

        .no-rooms {
            grid-column: 1 / -1;
            text-align: center;
            padding: 3rem;
            color: #b0b0b0;
            font-family: 'Lato', sans-serif;
        }

        .loading {
            grid-column: 1 / -1;
            text-align: center;
            padding: 3rem;
            color: #b0b0b0;
            font-family: 'Lato', sans-serif;
        }

        @media (max-width: 768px) {
            .rooms-grid {
                grid-template-columns: 1fr;
            }

            .filter-grid {
                grid-template-columns: 1fr;
            }

            .room-header {
                flex-direction: column;
                gap: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="logo">
                <h1>üè® Luxury Hotel</h1>
            </div>
            <nav class="nav">
                <a href="index.html">Home</a>
                <a href="rooms.html" class="active">Rooms</a>
                <a href="booking.html">Booking</a>
                <a href="feedback.html">Feedback</a>
                <div id="authSection">
                    <!-- Dynamic auth buttons -->
                </div>
            </nav>
        </div>
    </header>

    <main class="container rooms-page">
        <div class="page-header">
            <h1>Our Luxury Rooms</h1>
            <p>Experience unparalleled comfort and style in our carefully curated selection of rooms and suites.</p>
        </div>

        <!-- Filter Section -->
        <div class="filter-section">
            <h3 style="margin-bottom: 1rem; color: #2c3e50;">Filter Rooms</h3>
            <div class="filter-grid">
                <div class="filter-group">
                    <label>Room Type</label>
                    <select id="filterType" onchange="filterRooms()">
                        <option value="">All Types</option>
                        <option value="Standard">Standard</option>
                        <option value="Deluxe">Deluxe</option>
                        <option value="Executive">Executive</option>
                        <option value="Suite">Suite</option>
                        <option value="Presidential">Presidential</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Price Range</label>
                    <select id="filterPrice" onchange="filterRooms()">
                        <option value="">Any Price</option>
                        <option value="0-200">$0 - $200</option>
                        <option value="201-400">$201 - $400</option>
                        <option value="401-600">$401 - $600</option>
                        <option value="601-1000">$601+</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Status</label>
                    <select id="filterStatus" onchange="filterRooms()">
                        <option value="">All Status</option>
                        <option value="Available">Available</option>
                        <option value="Reserved">Reserved</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Rooms Grid -->
        <div class="rooms-grid" id="roomsGrid">
            <div class="loading">
                <h3>Loading available rooms...</h3>
                <p>Please wait while we fetch the latest room availability.</p>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2023 Luxury Hotel. All rights reserved.</p>
        </div>
    </footer>

    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/main.js"></script>
    <script>
        // Update navigation
        auth.updateNavigation();

        let allRooms = [];
        let filteredRooms = [];

        // Load rooms for users
        async function loadRooms() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/rooms`);
                const data = await response.json();
                
                if (Array.isArray(data)) {
                    allRooms = data;
                    filteredRooms = [...allRooms];
                    displayRooms();
                } else {
                    document.getElementById('roomsGrid').innerHTML = `
                        <div class="no-rooms">
                            <h3>No rooms available at the moment</h3>
                            <p>Please check back later or contact us for availability.</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading rooms:', error);
                document.getElementById('roomsGrid').innerHTML = `
                    <div class="no-rooms">
                        <h3>Error loading rooms</h3>
                        <p>Please try again later or contact support.</p>
                    </div>
                `;
            }
        }

        // Display rooms
        function displayRooms() {
            const container = document.getElementById('roomsGrid');
            
            if (filteredRooms.length === 0) {
                container.innerHTML = `
                    <div class="no-rooms">
                        <h3>No rooms match your filters</h3>
                        <p>Try adjusting your search criteria.</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredRooms.map(room => {
                // Default image based on room type
                const roomImages = {
                    'Standard': 'https://images.unsplash.com/photo-1631049307264-da0ec9d70304?w=400',
                    'Deluxe': 'https://images.unsplash.com/photo-1611892440504-42a792e24d32?w=400',
                    'Executive': 'https://images.unsplash.com/photo-1566665797739-1674de7a421a?w=400',
                    'Suite': 'https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?w=400',
                    'Presidential': 'https://images.unsplash.com/photo-1590490360182-c33d57733427?w=400'
                };

                const roomImage = room.images && room.images.length > 0 
                    ? room.images[0] 
                    : roomImages[room.type] || roomImages['Standard'];

                const isAvailable = room.status === 'Available';
                const isUserLoggedIn = auth.isLoggedIn();

                return `
                <div class="room-card">
                    <div class="room-image" style="background-image: url('${roomImage}')">
                        <div class="room-overlay">
                            ${isAvailable ? 
                                `<a href="booking.html?room=${room._id}" class="book-btn">Book Now</a>` :
                                `<button class="book-btn" disabled>Not Available</button>`
                            }
                        </div>
                        <div class="room-status status-${room.status.toLowerCase()}">
                            ${room.status}
                        </div>
                    </div>
                    
                    <div class="room-content">
                        <div class="room-header">
                            <h3 class="room-name">${room.name}</h3>
                            <div class="room-price">$${room.price}/night</div>
                        </div>
                        
                        <div class="room-type">${room.type} Room</div>
                        
                        <p class="room-description">
                            ${room.description || 'Experience luxury and comfort in this beautifully appointed room.'}
                        </p>
                        
                        <div class="room-amenities">
                            ${(room.amenities || []).slice(0, 4).map(amenity => 
                                `<span class="amenity-tag">${amenity}</span>`
                            ).join('')}
                            ${room.amenities && room.amenities.length > 4 ? 
                                `<span class="amenity-tag">+${room.amenities.length - 4} more</span>` : ''
                            }
                        </div>
                        
                        <div class="room-footer">
                            <div class="room-capacity">
                                üë• Sleeps ${room.capacity || 2} guests
                            </div>
                            ${isAvailable ? 
                                `<a href="booking.html?room=${room._id}" class="book-btn">
                                    ${isUserLoggedIn ? 'Book Now' : 'Login to Book'}
                                </a>` :
                                `<button class="book-btn" disabled>Not Available</button>`
                            }
                        </div>
                    </div>
                </div>
                `;
            }).join('');
        }

        // Filter rooms
        function filterRooms() {
            const typeFilter = document.getElementById('filterType').value;
            const priceFilter = document.getElementById('filterPrice').value;
            const statusFilter = document.getElementById('filterStatus').value;

            filteredRooms = allRooms.filter(room => {
                // Type filter
                if (typeFilter && room.type !== typeFilter) return false;
                
                // Status filter
                if (statusFilter && room.status !== statusFilter) return false;
                
                // Price filter
                if (priceFilter) {
                    const [min, max] = priceFilter.split('-').map(Number);
                    if (max && (room.price < min || room.price > max)) return false;
                    if (!max && room.price < min) return false;
                }
                
                return true;
            });

            displayRooms();
        }

        // Load rooms on page load
        loadRooms();
    </script>
</body>
</html>